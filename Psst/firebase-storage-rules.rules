rules_version = '2';

// Firebase Storage Security Rules for Psst Messaging App
// Created by Caleb (Coder Agent) - PR #17

service firebase.storage {
  match /b/{bucket}/o {
    
    // Profile photos - users can only write their own, anyone can read
    // Path format: profile_photos/{userId}/profile.jpg
    match /profile_photos/{userId}/{allPaths=**} {
      // Allow anyone to read profile photos (public)
      allow read: if true;
      
      // Allow write only if authenticated and writing to own folder
      allow write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
